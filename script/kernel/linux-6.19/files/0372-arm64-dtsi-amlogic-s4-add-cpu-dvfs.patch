Patch from MiniMyth2 project

Developed-by: Piotr Oniszczuk <piotr.oniszczuk@gmail.com>
Signed-off-by: Piotr Oniszczuk <piotr.oniszczuk@gmail.com>



diff --speed-large-files --no-dereference --minimal -Naur linux-6.19/arch/arm64/boot/dts/amlogic/meson-s4.dtsi linux-6.19/arch/arm64/boot/dts/amlogic/meson-s4.dtsi
--- linux-6.19/arch/arm64/boot/dts/amlogic/meson-s4.dtsi	2026-02-09 17:01:04.481324821 +0100
+++ linux-6.19/arch/arm64/boot/dts/amlogic/meson-s4.dtsi	2026-02-09 17:00:46.935339567 +0100
@@ -28,6 +28,7 @@
 			compatible = "arm,cortex-a35";
 			reg = <0x0 0x0>;
 			enable-method = "psci";
+			opp-table-v2 = <&cpu_opp_table>;
 			#cooling-cells = <2>;
 		};
 
@@ -36,6 +37,7 @@
 			compatible = "arm,cortex-a35";
 			reg = <0x0 0x1>;
 			enable-method = "psci";
+			opp-table-v2 = <&cpu_opp_table>;
 			#cooling-cells = <2>;
 		};
 
@@ -44,6 +46,7 @@
 			compatible = "arm,cortex-a35";
 			reg = <0x0 0x2>;
 			enable-method = "psci";
+			opp-table-v2 = <&cpu_opp_table>;
 			#cooling-cells = <2>;
 		};
 
@@ -52,10 +55,116 @@
 			compatible = "arm,cortex-a35";
 			reg = <0x0 0x3>;
 			enable-method = "psci";
+			opp-table-v2 = <&cpu_opp_table>;
 			#cooling-cells = <2>;
 		};
 	};
 
+	cpu_opp_table: cpu-opp-table {
+		compatible = "amlogic,meson-s4-cpu-operating-points";
+		secure-monitor = <&sm>;
+		opp-shared;
+
+		opp-100000000 {
+		    opp-hz = /bits/ 64 <100000000>;
+		    opp-microvolt-bin0 = <769000>;
+		    opp-microvolt-bin1 = <769000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-250000000 {
+		    opp-hz = /bits/ 64 <250000000>;
+		    opp-microvolt-bin0 = <769000>;
+		    opp-microvolt-bin1 = <769000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-500000000 {
+		    opp-hz = /bits/ 64 <500000000>;
+		    opp-microvolt-bin0 = <769000>;
+		    opp-microvolt-bin1 = <769000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-666000000 {
+		    opp-hz = /bits/ 64 <666000000>;
+		    opp-microvolt-bin0 = <769000>;
+		    opp-microvolt-bin1 = <769000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1000000000 {
+		    opp-hz = /bits/ 64 <1000000000>;
+		    opp-microvolt-bin0 = <769000>;
+		    opp-microvolt-bin1 = <769000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1200000000 {
+		    opp-hz = /bits/ 64 <1200000000>;
+		    opp-microvolt-bin0 = <769000>;
+		    opp-microvolt-bin1 = <769000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1404000000 {
+		    opp-hz = /bits/ 64 <1404000000>;
+		    opp-microvolt-bin0 = <799000>;
+		    opp-microvolt-bin1 = <799000>;
+		    opp-microvolt-bin2 = <759000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1500000000 {
+		    opp-hz = /bits/ 64 <1500000000>;
+		    opp-microvolt-bin0 = <829000>;
+		    opp-microvolt-bin1 = <829000>;
+		    opp-microvolt-bin2 = <769000>;
+		    opp-microvolt-bin3 = <759000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1608000000 {
+		    opp-hz = /bits/ 64 <1608000000>;
+		    opp-microvolt-bin0 = <869000>;
+		    opp-microvolt-bin1 = <869000>;
+		    opp-microvolt-bin2 = <799000>;
+		    opp-microvolt-bin3 = <769000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1704000000 {
+		    opp-hz = /bits/ 64 <1704000000>;
+		    opp-microvolt-bin0 = <909000>;
+		    opp-microvolt-bin1 = <909000>;
+		    opp-microvolt-bin2 = <829000>;
+		    opp-microvolt-bin3 = <809000>;
+		    clock-latency-ns = <50000>;
+		};
+
+		opp-1800000000 {
+			opp-hz = /bits/ 64 <1704000000>;
+			opp-microvolt-bin0 = <1009000>;
+			opp-microvolt-bin1 = <1009000>;
+			opp-microvolt-bin2 = <999000>;
+			opp-microvolt-bin3 = <939000>;
+			clock-latency-ns = <50000>;
+		};
+	};
+
 	timer {
 		compatible = "arm,armv8-timer";
 		interrupts = <GIC_PPI 13 (GIC_CPU_MASK_SIMPLE(4) | IRQ_TYPE_LEVEL_LOW)>,
--

MiniMyth2

